# ๐ ุฑุงูููุง ุงุฌุฑุง Migration

## ูุฑุญูู 1: ุฏุณุชุฑุณ ุจู Supabase Dashboard

1. ุจู [https://supabase.com](https://supabase.com) ุจุฑูุฏ
2. ูุงุฑุฏ ูพุฑูฺู ุฎูุฏ ุดูุฏ
3. ุงุฒ ููู ุณูุช ฺูพุ ฺฏุฒูู **SQL Editor** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ

## ูุฑุญูู 2: ุงุฌุฑุง Migration

1. ุฑู **New Query** ฺฉูฺฉ ฺฉูุฏ
2. ูุญุชูุง ูุงู ุฒุฑ ุฑุง ฺฉูพ ฺฉูุฏ:
   ```
   supabase/migrations/20250115000000_crm_system_base.sql
   ```
3. ุฏุฑ SQL Editor ูพุณุช ฺฉูุฏ
4. ุฑู **Run** ฺฉูฺฉ ฺฉูุฏ
5. ููุชุธุฑ ุจูุงูุฏ ุชุง ุงุฌุฑุง ฺฉุงูู ุดูุฏ (ุญุฏูุฏ 10-20 ุซุงูู)

## ูุฑุญูู 3: ุจุฑุฑุณ ููููุช

ุจุนุฏ ุงุฒ ุงุฌุฑุงุ ุจุฑุฑุณ ฺฉูุฏ:

### ฺฺฉ ฺฉุฑุฏู ุฌุฏุงูู:
1. ุงุฒ ูููุ **Table Editor** ุฑุง ุจุงุฒ ฺฉูุฏ
2. ุจุงุฏ ุฌุฏุงูู ุฒุฑ ุฑุง ุจุจูุฏ:
   - customers
   - projects
   - project_files
   - invoices
   - invoice_items
   - payments
   - support_tickets
   - ticket_messages
   - ticket_files
   - notifications
   - activity_logs

### ฺฺฉ ฺฉุฑุฏู Functions:
1. ุงุฒ ูููุ **Database** > **Functions** ุฑุง ุจุงุฒ ฺฉูุฏ
2. ุจุงุฏ functions ุฒุฑ ุฑุง ุจุจูุฏ:
   - update_updated_at_column
   - generate_invoice_number
   - generate_ticket_number
   - calculate_invoice_total
   - log_activity

## ูุฑุญูู 4: ุงุฌุงุฏ ุงููู Admin

ุจุฑุง ุฏุณุชุฑุณ ุจู ูพูู ุงุฏููุ ุจุงุฏ ฺฉ ฺฉุงุฑุจุฑ admin ุงุฌุงุฏ ฺฉูุฏ:

```sql
-- ุงุจุชุฏุง ฺฉ ฺฉุงุฑุจุฑ ุฏุฑ Authentication ุงุฌุงุฏ ฺฉูุฏ
-- ุณูพุณ ุงู query ุฑุง ุงุฌุฑุง ฺฉูุฏ (USER_ID ุฑุง ุจุง id ฺฉุงุฑุจุฑ ุฌุงฺฏุฒู ฺฉูุฏ)

INSERT INTO public.user_roles (user_id, role)
VALUES ('USER_ID', 'admin');
```

## ูุฑุญูู 5: ุชุณุช

1. ูุงุฑุฏ ุณุงุช ุดูุฏ
2. ุจู `/admin` ุจุฑูุฏ
3. ุจุงุฏ ุจู ูพูู ุงุฏูู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ

## โ๏ธ ูฺฉุงุช ููู

- ูุจู ุงุฒ ุงุฌุฑุงุ ุญุชูุงู backup ุงุฒ ุฏุชุงุจุณ ุจฺฏุฑุฏ
- ุงฺฏุฑ ุฎุทุง ุฏุฑุงูุช ฺฉุฑุฏุฏุ ุชูุงู query ุฑุง ูพุงฺฉ ฺฉูุฏ ู ุฏูุจุงุฑู ุงูุชุญุงู ฺฉูุฏ
- ุงฺฏุฑ ุฌุฏุงูู ูุจู ุจุง ููู ูุงู ุฏุงุฑุฏุ ุงุจุชุฏุง ุขููุง ุฑุง ุญุฐู ฺฉูุฏ

## ๐ ุฑูุน ูุดฺฉูุงุช

### ุฎุทุง: "relation already exists"
ุฌุฏุงูู ูุจูุงู ุงุฌุงุฏ ุดุฏูุงูุฏ. ุขููุง ุฑุง ุญุฐู ฺฉูุฏ ุง ูุงู ุนูุถ ฺฉูุฏ.

### ุฎุทุง: "function has_role does not exist"
Migration ูุจู (20251103155510) ุฑุง ุงุฌุฑุง ูฺฉุฑุฏูุงุฏ. ุงุจุชุฏุง ุขู ุฑุง ุงุฌุฑุง ฺฉูุฏ.

### ุฎุทุง: "permission denied"
RLS policies ูุนุงู ูุณุชูุฏ. ุจุง ฺฉุงุฑุจุฑ admin ูุงุฑุฏ ุดูุฏ.

## โ ุชฺฉูู

ุจุนุฏ ุงุฒ ุงุฌุฑุง ูููู migrationุ ูุชูุงูุฏ ุจู ูุงุฒ 2 ุจุฑูุฏ!
